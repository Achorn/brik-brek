(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function i(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=i(s);fetch(s.href,a)}})();const P="#f0dede",U="#cf3673",v="#748cbb",C=document.querySelector("#title-container"),N=document.querySelector("#game-over");document.querySelector("#game-over-title");const I=document.querySelector("#score"),G=document.querySelector("#lives"),_=document.querySelector("#level");let R=0,M=3,L=1,h={up:!1,left:!1,right:!1,reset:!1},F=65,f=document.querySelector("#my-canvas"),r=f.getContext("2d"),l=[],S=.45,X=1,p=[],x=[],c="START",u={entering:!1,Offset:0},H=t=>{if(u.entering)if(u.Offset<0){let e=t*.4;u.Offset+=e,p.forEach(i=>{i.id!="paddle"&&(i.startY=i.startY+e)})}else u.entering=!1};const E=()=>{for(let t=0;t<5;t++)for(let e=0;e<4;e++){let i=Math.random(),o=Math.random(),s=i<.333333?U:i<.66666?"#855c8c":v;p.push({startX:25+t*140,startY:F+e*50+u.Offset,width:100,height:30,toDispose:!1,id:t+e,color:s,power:o>.8?"ball":o>.7?"speed":o>.6?"paddle":""})}};E();let O=t=>({x:t.startX+t.width*.5,y:t.startY+t.height*.5}),K=()=>{p.forEach(t=>{if(r.fillStyle=t.color,r.fillRect(t.startX,t.startY,t.width,t.height),t.power){if(t.power=="ball"&&(r.beginPath(),r.arc(t.startX+t.width*.5,t.startY+t.height*.5,t.height*.3,0,2*Math.PI),r.fillStyle=P,r.fill()),t.power=="speed"){let e=t.height*.3;r.beginPath(),r.beginPath(),r.moveTo(t.startX-t.width*.5+e+t.width-3,t.startY+t.height*.5),r.lineTo(t.startX+t.width*.5-e,t.startY+t.height*.5-e),r.lineTo(t.startX+t.width*.5-e,t.startY+t.height*.5+e),r.fillStyle=P,r.fill()}t.power=="paddle"&&(r.fillStyle=t.color,r.fillStyle=P,r.fillRect(t.startX+25,t.startY+10,t.width-50,t.height-20),r.fill())}})},V=t=>{if(t.power){if(t.power=="ball"){let e=O(t),i={radius:15,positionX:e.x,positionY:e.y,xDirection:1,yDirection:-1,speed:S,color:t.color,life:1,toDispose:!1};l.push(i)}t.power=="speed"&&x.push(new et),t.power=="paddle"&&x.push(new it)}},d={startX:f.width*.5-150*.5,startY:f.height-50,width:150,height:20,toDispose:!1,color:v,id:"paddle"};p.push(d);const j=t=>{let e=0;h.left&&(e-=.5*t),h.right&&(e+=.5*t),d.startX=d.startX+e,d.startX<=0&&(d.startX=5),d.startX+d.width>=f.width&&(d.startX=f.width-d.width-5)};let T={radius:15,positionX:f.width/2,positionY:f.width/2,xDirection:0,yDirection:-1,speed:S,color:"white",life:1,toDispose:!1};T.positionY=f.height-80;l.push(T);let W=t=>{c=="START"?(l[0].positionX=d.startX+d.width*.5,l[0].positionY=d.startY-30):l.forEach(e=>z(e,t))},z=(t,e)=>{t.positionX+=t.speed*X*e*t.xDirection,t.positionY+=t.speed*X*e*t.yDirection,t.positionY-t.radius<=0&&(t.yDirection=Math.abs(t.yDirection)),t.positionX+t.radius>=f.width&&(t.xDirection=-Math.abs(t.xDirection)),t.positionX-t.radius<=0&&(t.xDirection=Math.abs(t.xDirection)),t.positionY-t.radius>f.height&&(t.toDispose=!0)},J=()=>{l.forEach(t=>Q(t))},Q=t=>{r.beginPath(),r.arc(t.positionX,t.positionY,t.radius,0,2*Math.PI),r.fillStyle=t.color,r.fill()};const Z=()=>{l=l.filter(t=>!t.toDispose)},$=()=>{p.forEach(t=>{l.forEach(e=>{if(k(t,e)){let i=b(t,e);if(i==1&&(e.yDirection=1),i==2&&(e.xDirection=-1),i==3&&(e.xDirection=1),i==4&&(e.yDirection=-1),t.id!="paddle")V(t),t.toDispose=!0,R+=50;else{let o={start:t.startX,end:t.startX+t.width,center:t.startX+t.width*.5},s=e.positionX-o.start,a=o.center-o.start;(s-a)/t.width;let n=(s-a)/t.width;n=Math.max(-.3,n),n=Math.min(.3,n),n*=2,n*=90,n<=0?n+=90:n-=90;let w=n<=0?1:-1,g=Math.abs(n),y=1;const D=g*Math.PI/180,Y=y*Math.sin(D),m=y*Math.cos(D);e.xDirection=m*w,e.yDirection=-Y}}})})},k=(t,e)=>{let i=O(t),o=i.x,s=i.y,a=e.positionX-o,n=e.positionY-t.startY,w=o+Math.max(Math.min(a,t.width/2),-t.width/2),g=s+Math.max(Math.min(n,t.height/2),-t.height/2);return Math.sqrt((e.positionX-w)**2+(e.positionY-g)**2)<=e.radius},b=(t,e)=>{let i={x:t.startX+t.width*.5,y:t.startY+t.height*.5},o=Math.atan2(i.x-e.positionX,i.y-e.positionY),s={x:t.startX,y:t.startY+t.height},a={x:t.startX+t.width,y:t.startY+t.height},n={x:t.startX,y:t.startY},w={x:t.startX+t.width,y:t.startY},g=Math.atan2(i.x-s.x,i.y-s.y),y=Math.atan2(i.x-a.x,i.y-a.y),D=Math.atan2(i.x-n.x,i.y-n.y),Y=Math.atan2(i.x-w.x,i.y-w.y),m=4;return o>g||o<y?m=1:o>D&&o<g?m=2:o>y&&o<Y&&(m=3),m},tt=t=>{console.log("ball power: ",X),x=x.filter(e=>!e.toDispose),console.log(x),x.forEach(e=>{e.update(t)})};class B{constructor(){this.toDispose=!1}initPowerUp(){}update(e){}}class et extends B{constructor(){super(),this.timeLeft=5e3,this.initPowerUp()}initPowerUp(){X=1.35}update(e){this.timeLeft-=e,this.timeLeft<=0&&(console.log("disposing"),this.toDispose=!0,X=1)}}class it extends B{constructor(){super(),this.timeLeft=5e3,this.initPowerUp()}initPowerUp(){d.width=250}update(e){this.timeLeft-=e,this.timeLeft<=0&&(this.toDispose=!0,d.width=150)}}document.addEventListener("keydown",t=>{t.code==="ArrowLeft"&&(h.left=!0),t.code==="ArrowRight"&&(h.right=!0),t.code==="ArrowUp"&&(c==="START"&&(c="PLAYING"),h.up=!0),t.code==="KeyR"&&(h.reset=!0)});document.addEventListener("keyup",t=>{t.code==="ArrowLeft"&&(h.left=!1),t.code==="ArrowRight"&&(h.right=!1),t.code==="ArrowUp"&&(h.up=!1),t.code==="KeyR"&&(h.reset=!1)});const st=()=>{p=p.filter(t=>!t.toDispose)},rt=()=>{I.innerHTML=R};let A=16,q=t=>{const e=t-A;e&&(r.clearRect(0,0,f.width,f.height),$(),j(e),H(e),W(e),tt(e),c=="PLAYING"&&(C.style.display="none",st(),Z(),p.length==1&&(L=L+1,u.entering=!0,u.Offset=-400,_.innerHTML=L,E()),l.length==0&&(M===0?(c="OVER",N.style.display="flex"):(c="START",M-=1,G.innerHTML=M,l.push({radius:15,positionX:d.startX+d.width*.5,positionY:d.startY-30,xDirection:0,yDirection:-1,speed:S,color:"white",life:1,toDispose:!1})))),c=="OVER"&&h.reset&&location.reload(),K(),J(),rt(),A=t),requestAnimationFrame(q)};q();
//# sourceMappingURL=index-BCIsqd7w.js.map
